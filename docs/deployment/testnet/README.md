# Threefoldhub testnet

The threefoldhub testnet is created against the BUSD token in BSC testnet. Its contract address is 0x78867BbEeF44f2326bF8DDd1941a4439382EF2A7.

The chain is bootstraped with `threefold` account having 2TFTs, 1 staked and 1 unbonded. If ensuring all money in the chain is transferable to BSC, the 2TFTs can be sent to the graivty smart contract address (this doesn't ensure transferability of minted/slashed tokens).

## URLs

Frontend: https://threefoldhub.test.gridtesting.xyz
Tendermint endpoint: https://threefoldhub.test.gridtesting.xyz:26657
Cosmos REST endpoint: https://threefoldhub.test.gridtesting.xyz:1317

## Chain Configuration

### Genesis

The modules' default genesis is generated by executing the following:
```sh
threefold_hubd --home ~/.threefold_hub_devnet init threefold --chain-id threefold-hub-testnet
threefold_hubd --home ~/.threefold_hub_devnet keys add placeholder --keyring-backend test --recover 
threefold_hubd --home ~/.threefold_hub_devnet keys add threefold --keyring-backend test --recover
threefold_hubd --home ~/.threefold_hub_devnet add-genesis-account placeholder 0TFT --keyring-backend test
threefold_hubd --home ~/.threefold_hub_devnet add-genesis-account threefold 2000000000000000000TFT --keyring-backend test
threefold_hubd --home ~/.threefold_hub_devnet gentx --moniker threefold threefold 1000000000000000000TFT 0xD6DBC796aC81DC34bDe3864f1F2c8f40742D85Dc tf12m75luwtqthas2kkc53p4kwsakatptfgn6sunz --chain-id=threefold-hub-testnet --keyring-backend=test
threefold_hubd --home ~/.threefold_hub_devnet collect-gentxs
```

A placeholder account is created because keplr doesn't work with account id 0.

The [genesis](./config/genesis.json) file contains the default generated genesis with the following changes:
- crisis constant fee to `600000000000000000TFT`
- gov `min_deposit` to `1000000000000000TFT`
- gov `voting_period` to 2 hours
- `gravity_id` to `threefold-hub-testnet`
- `bridge_ethereum_address` to `0x3cA7E73486aCe8f18662AeA0B6BC23A580B9d04e`. This corresponds to the gravity smart contract address. It's currently not used by the module (i.e. it's for doc-purposes only for now).
- `bridge_chain_id` is 97. The BSC testnet chain id.
- Gravity's `average_ethereum_block_time` to 3000. This value is used to estimate blocks timeout.
- The following `erc20` token is added to gravity:
```json
       "eth_erc20_to_denoms": [
          {
            "erc20": "0x78867BbEeF44f2326bF8DDd1941a4439382EF2A7",
            "denom": "TFT"
         }
       ]
```
- `mint_denom` to TFT
- `bond_denom` to TFT

### Tendermint configuration

The `cors_allowed_origins` property in the tenderming [config](./config/config.toml) file is changed to `["*"]` to allow connecting from any website. The listening address is changed for reverse-proxying puropses. Everything else is the default.

### App configuration
The min gas price is set in the [app](./config/app.toml) config flie as the approximate value of .025uatom in USDs. A couple of zeroes are removed because of precision issues in the frontend. This is done instead of a proper fix because the decimals of TFT is 7 so it won't be a problem.
- The `minimum-gas-prices` is specified as `6000000000TFT`.
- The REST endpoint and swagger is enabled
- The listening address is changed for reverse-proxying puropses
- `enabled-unsafe-cors` is changed to `true`

## Orchestrator configuration

The orchestrator is [configured](./config/gbt.yaml) to request batch for every send-to-eth tx. The relayer is enabled and it relays only batches with fees larger than .0001 BUSD. The orchestrator must be run by every validator in the cosmos chain. But they don't have to necessarily run the relayer, only one is sufficient. 

The service file used to run it can be found [here](./services/threefold-gbt.service).
## Chain node service

The service file used to run the chain node service can be found [here](./services/threefold-node.service). It's run using cosmovisor to manage auto-updates. Initially, the `threefold_hubd` binary must be copied to `~/.threefold_hub/cosmovisor/genesis/bin/threefold_hubd`.

## Gravity contract

The contract is created with the following parameters:
- gravity id: `0x7468726565666F6C642D6875622D746573746E65740000000000000000000000`
- validator set: `["0xD6DBC796aC81DC34bDe3864f1F2c8f40742D85Dc"]`
- validator powers: `[4294967296]`

Its address is `0x3cA7E73486aCe8f18662AeA0B6BC23A580B9d04e`